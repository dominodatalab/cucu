{% extends "layout.html" %}
{% block content %}
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="#">HTML Test Report</a>

            <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
              <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                <li class="nav-item active">
                  <a class="nav-link" href="../../index.html">Top</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Logs
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                      {% for log_file in scenario['logs'] %}
                      <a class="dropdown-item" href="{{ log_file['filepath'] }}">{{ log_file['name'] }}</a>
                      {% endfor %}
                    </div>
                  </li>
              </ul>
            </div>
        </div>
    </nav>
    <table class="table table-borderless">
        <tr>
            <td><pre style="display: inline; color: maroon;">Scenario:</pre> {{ scenario['name'] }}</td>
            <td style="color: gray;"></td>
        </tr>
        {% for step in steps %}
            {% set step_name = step['keyword'] + ' ' + step['name'] %}
            {% if step['substep'] %}
                {% set step_prefix = "     â¤·" %}
            {% else %}
                {% set step_prefix = "" %}
            {% endif %}
            <tr>
                {% if step['result'] is not defined %}
                    <td><pre style="display: inline; color: blue;">{{ step_prefix }}{{ step_name }}</pre></td>
                    <td></td>
                {% elif step['result']['status'] == 'passed' %}
                    <td><pre style="display: inline; color: green">{{ step_prefix }}{{ step['keyword'].rjust(6, ' ') }}</pre><pre style="display: inline"> {{ step['name'] }}</pre></td>
                    <td><pre style="display: inline; color: gray;"># {{ '{:.3f}'.format(step['result']['duration']) }}s</pre></td>
                {% elif step['result']['status'] == 'failed' %}
                    <td><pre style="display: inline; color: red">{{ step_prefix }}{{ step_name }}</pre></td>
                    <td><pre style="display: inline; color: gray;"># {{ '{:.3f}'.format(step['result']['duration']) }}s</pre></td>
                {% elif step['result']['status'] == 'skipped' %}
                    <td><pre style="display: inline; color: blue">{{ step_prefix }}{{ step_name }}</pre></td>
                {% endif %}
            </tr>
            {% if step['text'] %}
            <tr>
                <td colspan="2">
                    <pre style="color: black; margin: 0">      """</pre>
                    {% for line in step['text'] %}
                    <pre style="color: black; margin: 0">      {{line}}</pre>
                    {% endfor %}
                    <pre style="color: black; margin: 0">      """</pre>
                </td>
            </tr>
            {% endif %}
            {% if step['table'] %}
            <tr>
                <td colspan="2">
                    <pre style="color: black; margin: 0; display: inline">      |</pre>
                    {% for heading in step['table']['headings'] %}
                    <pre style="color: black; margin: 0; display: inline"> {{ heading }} |</pre>
                    {% endfor %}
                    </br>
                    {% for row in step['table']['rows'] %}
                        <pre style="color: black; margin: 0; display: inline">      |</pre>
                        {% for value in row %}
                        <pre style="color: black; margin: 0; display: inline"> {{ value }} |</pre>
                        {% endfor %}
                        </br>
                    {% endfor %}
                </td>
            </tr>
            {% endif %}
            {% if step['result'] is defined %}
                {% if step['result']['stdout'] %}
                <tr>
                    {% for line in step['result']['stdout'] %}
                        <td colspan="2"><pre style="color: darkgray">{{ line }}</pre></td>
                    {% endfor %}
                </tr>
                {% endif %}
            {% endif %}
            {% if step['image'] is defined and step['result'] is defined %}
            <tr>
                <td colspan="2"><img class="col-12 shadow p-3 mb-5 bg-white rounded" alt='{{ step_name }}' title='{{ step_name }}' src='{{ step["image"] }}'></img></td>
            </tr>
            {% endif %}
        {% endfor %}
    </table>
    </script>
{% endblock %}
